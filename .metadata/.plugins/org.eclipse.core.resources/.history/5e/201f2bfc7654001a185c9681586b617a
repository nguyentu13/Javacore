package truong.nguyen.spring_boot_api.service;


import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import org.springframework.stereotype.Service;

import truong.nguyen.spring_boot_api.model.Role;
import truong.nguyen.spring_boot_api.repository.RoleRepository;

@Service
public class RoleService extends BaseService implements RoleRepository{

	@Override
	public List<Role> getAll() throws Exception {
		List<Role> list= new ArrayList<Role>();
		sql  = "select * from role";
		preparedSql();
		ResultSet  rs = executeQuery();
		if(rs!=null) {
			try {
				while(rs.next()) {
					Role role = new Role();
					role.setId(rs.getInt("id"));
					role.setName(rs.getString("role"));
					list.add(role);
				}
			} finally {
				rs.close();
			}
		}
		releaseConnection();
		return list;
	}

	@Override
	public Role getById(int id) throws Exception{
		Role role = null;
		sql  = "select * from role where id = ?";
		preparedSql();
//		PreparedStatement ps = conn.prepareStatement(sql);
//		ps.setInt(1,id);
//		preparedSql();
		setInt(1);
		ResultSet  rs = executeQuery();
		if(rs!=null) {
			try {
				while(rs.next()) {
					role = new Role();
					role.setId(rs.getInt("id"));
					role.setName(rs.getString("role"));
				}
			} finally {
				
				rs.close();
				ps.close();
				conn.close();
			}
		}
//		releaseConnection();
		return role;
	}
	
}
