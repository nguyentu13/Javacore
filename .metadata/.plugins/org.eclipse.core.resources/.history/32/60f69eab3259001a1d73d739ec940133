package com.xtel.vngolf.api.model;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import com.tbv.utils.db.cmd.DbPagingCmd;
import com.tbv.utils.db.entities.PagingEntity;
import com.xtel.vngolf.api.common.utils.AppUtils;
import com.xtel.vngolf.api.listener.entities.CmsUser;

import oracle.jdbc.OracleTypes;

public class DbCmsUserCmsGetListCmd extends DbPagingCmd {

	private int user_id;
	private int pageIdx;
	private int pageSize;
	private String user_name;
	private String full_name;
	private String email;
	private String phone;
	private String address;
	private String unit;
	private int status;
	private String order_by;
	
	private List<CmsUser> lsUser = new ArrayList<CmsUser>();

	public DbCmsUserCmsGetListCmd(String transid, String channel, int user_id, int pageIdx, int pageSize,
			String user_name, String full_name, String email, String phone, String address, String unit, int status,
			String order_by) {
		super(transid, channel);
		this.user_id = user_id;
		this.pageIdx = pageIdx;
		this.pageSize = pageSize;
		this.user_name = user_name;
		this.full_name = full_name;
		this.email = email;
		this.phone = phone;
		this.address = address;
		this.unit = unit;
		this.status = status;
		this.order_by = order_by;

	}

	@Override
	protected void setSqlCommand() throws Exception {
		setProc("getAllUser", 0);
	}

	@Override
	protected void setSqlParameter() throws Exception {
	}

	@Override
	protected void getOutputResult() throws Exception {
		code = cst.getInt(1);
		message = cst.getString(2);

		totalRecord = cst.getInt(14);
		totalPage = cst.getInt(15);
		beginIdx = cst.getInt(16);
		endIdx = cst.getInt(17);

		pageInfo = new PagingEntity(pageIdx, pageSize, totalRecord, totalPage, beginIdx, endIdx);
		ResultSet rsUser = null;
		try {
			rsUser = (ResultSet) cst.getObject(18);
			if(rsUser != null) {
				while (rsUser.next()) {
					int id=rsUser.getInt("id");
					String user_name=rsUser.getString("user_name");
					String full_name=rsUser.getString("full_name");
					Date birthday=rsUser.getDate("birth_day");
					String email=rsUser.getString("email");
					String phone_int=rsUser.getString("phone");
//					String mobile_int=rsUser.getString("mobile_number");
					String sex=rsUser.getString("gender");
					String address=rsUser.getString("address");
//					String unit=rsUser.getString("unit");
//					int status=rsUser.getInt("status");
//					int is_admin=rsUser.getInt("is_admin");
//					Date create_time=rsUser.getDate("create_time");
//					String create_by=rsUser.getString("create_by");
//					Date update_time=rsUser.getDate("update_time");
//					String update_by=rsUser.getString("update_by");
//					int schedule_id=rsUser.getInt("schedule_id");

					CmsUser user_info = new CmsUser();
					user_info.setUser_id(id);
					user_info.setUser_name(user_name);
					user_info.setFull_name(full_name);
					user_info.setBirthday(AppUtils.formatTime(birthday));
					user_info.setEmail(email);
					user_info.setPhone_number(phone_int);
					user_info.setMobile_number("767676767");
					user_info.setSex(1);
					user_info.setAddress(address);
					user_info.setUnit("hahaha");
					user_info.setStatus(status);
//					user_info.setIs_admin(is_admin);
					user_info.setCreate_time(AppUtils.formatTime(create_time));
					user_info.setCreate_by(create_by);
					user_info.setUpdate_time(update_time);
					user_info.setUpdate_by(update_by);
					user_info.setSchedule_id(schedule_id);
					lsUser.add(user_info);
				}
			}
		}catch (Exception e) {
			throw e;
		}finally {
			if(rsUser != null) rsUser.close();
		}
	}

	public int getUser_id() {
		return user_id;
	}

	public int getPageIdx() {
		return pageIdx;
	}

	public int getPageSize() {
		return pageSize;
	}

	public String getUser_name() {
		return user_name;
	}

	public String getFull_name() {
		return full_name;
	}

	public String getEmail() {
		return email;
	}

	public String getPhone() {
		return phone;
	}

	public String getAddress() {
		return address;
	}

	public String getUnit() {
		return unit;
	}

	public int getStatus() {
		return status;
	}

	public String getOrder_by() {
		return order_by;
	}

	public List<CmsUser> getLsUser() {
		return lsUser;
	}

	@Override
	public String toString() {
		return super.toString()+", [user_id=" + user_id + ", pageIdx=" + pageIdx + ", pageSize=" + pageSize
				+ ", user_name=" + user_name + ", full_name=" + full_name + ", email=" + email + ", phone=" + phone
				+ ", address=" + address + ", unit=" + unit + ", status=" + status + ", order_by=" + order_by
				+ ", lsUser.size=" + (lsUser == null ? "null" : String.valueOf(lsUser.size()))+ "]";
	}

}
